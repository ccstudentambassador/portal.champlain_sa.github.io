<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Student Ambassador Homepage</title>
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.2.0/css/mdb.min.css" media="screen" title="no title">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" media="screen" title="no title">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="styles/styles.css" media="screen" title="no title">
  </head>
  <body>
    <nav>
      <!-- <img src="logo_color.png" alt="" /> -->
      <a id="logo-wrapper" href="index.html">
        <div class="logo">
          <span>STU</span>
          <img src="images/shield_color.png" alt=""/>
          <span>ENT &nbsp;</span>
        </div>
        <div class="logo">
          <span>AMBASSADORS</span>
        </div>
      </a>

      <div class="pages">
        <a href="index.html"><li>Home</li></a>
        <a href="#"><li>Extensions</li></a>
        <a href="#"><li>Counselor Map</li></a>
      </div>
    </nav>

    <div class="wrapper">
      <div class="links">
        <a href="https://bit.ly/admprojects">
          <div class="icon" id="tracker">
            <i class="fa fa-tasks fa-4x" aria-hidden="true"></i>
            <span>Project Tracker</span>
          </div>
        </a>
        <a href="https://docs.google.com/spreadsheets/d/1vGaOQqrJM0HVm87gGOAf7mBu6XWUnv9GiMFkY_qQ33A/edit#gid=777844220">
          <div class="icon" id="schedule">
            <i class="fa fa-th-list fa-4x" aria-hidden="true"></i>
            <span>Schedule</span>
          </div>
        </a>
        <a href="https://www.google.com/calendar/render?pli=1#h">
          <div class="icon" id="calendar">
            <i class="fa fa-calendar fa-4x" aria-hidden="true"></i>
            <span>Calendar</span>
          </div>
        </a>
        <a href="https://mail.google.com/mail/u/0/#inbox">
          <div class="icon" id="gmail">
            <i class="fa fa-envelope fa-4x" aria-hidden="true"></i>
            <span>Gmail</span>
          </div>
        </a>
        <a href="https://drive.google.com/drive/#my-drive">
          <div class="icon" id="drive">
            <img src="images/googledrive.ico" alt="">
            <span>Google Drive</span>
          </div>
        </a>
        <a href="http://bit.ly/F16SACoverage">
          <div class="icon" id="coverage">
            <i class="fa fa-clock-o fa-4x" aria-hidden="true"></i>
            <span>Shift Coverage</span>
          </div>
        </a>
        <a href="http://bit.ly/satrainingprogress">
          <div class="icon" id="wings">
            <img src="images/wings.png" alt="">
            <span>Wings Progress</span>
          </div>
        </a>
        <a href="pages/saotm.html">
          <div class="icon" id="saotm">
            <i class="fa fa-user fa-4x" aria-hidden="true"></i>
            <span>SAOTM</span>
          </div>
        </a>
      </div>
      <div class="news">
        <h1>Office Updates &amp; News</h1>
        <div class="items"></div>
      </div>
    </div>
    <footer>
      <div id="champlain">
        <img src="images/shield_color.png" alt=""/>
        <span>LET US DARE</span>
      </div>
      <span id="footer-background"></span>
    </footer>

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.2.0/js/mdb.min.js" charset="utf-8"></script>
    <script src="./assets/tabletop.js" charset="utf-8"></script>
    <script type="text/javascript">
      $("#coverage").click(function(event) {
        event.preventDefault();
        $("#coverage").css("background-color", "#EE3124");
        $("#coverage").addClass("animated shake");
        $("#coverage i").hide();
        $("#coverage").prepend('<i class="fa fa-user-secret fa-4x" aria-hidden="true"></i>');
        $("#coverage span").text("RIGHT CLICK â†’ Open In Incognito");
        setTimeout(function(){
          $("#coverage").css("background-color", "#00aeef");
          $("#coverage").removeClass("animated shake");
          $("#coverage i").hide();
          $("#coverage").prepend('<i class="fa fa-clock-o fa-4x" aria-hidden="true"></i>');
          $("#coverage span").text("Shift Coverage");
        }, 5000);
      });
      window.onload = function() { init() };

      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1WcXn7_LocnbqskQxmBs0G7XzayQTgtnaWjOVrW1BSwk/pubhtml';

      function init() {
        Tabletop.init( { key: public_spreadsheet_url,
                         callback: showInfo,
                         simpleSheet: true } )
      }

      function showInfo(data, tabletop) {
        $(".news .items").empty();
        if (data.length == 0){
          $(".news .items").append("<h3> No updates at this time </h3>").css("overflow-y", "hidden");
        } else {
          $(".news .items").css("overflow-y", "auto");
          var i;
          for(i = data.length - 1; i >= 0; i--){
            console.log(data[i].Date);
            $(".news .items").append(
              '<tr class="item"> <td class="date">' + data[i].Date + '</td> <td class="message">' + data[i].Message + '</td> </tr>'
            );
          }
        }
        setTimeout(function(){
          init();
        }, 10000);
      }
    </script>
  </body>
</html>
